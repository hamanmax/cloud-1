this.kubio=this.kubio||{},this.kubio.adminArea=function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=557)}({1:function(t,e){!function(){t.exports=this.wp.i18n}()},2:function(t,e){!function(){t.exports=this.lodash}()},33:function(t,e){!function(){t.exports=this.wp.url}()},50:function(t,e){!function(){t.exports=this.jQuery}()},557:function(t,e,i){"use strict";i.r(e),i.d(e,"initDemoImport",(function(){return U}));var n=i(2);let a={},o={};const s="ACTIVE",r="INSTALLED",l="NOT_INSTALLED",d=()=>o.slug||0,c=()=>o.name,u=()=>{var t;return(null===(t=o)||void 0===t?void 0:t.plugins)||[]},p=()=>o.thumb,f=()=>!o.is_pro,b=t=>{const e=Object(n.find)(a.demos,{slug:t});o=e},g=()=>a.ajax_nonce,m=t=>{var e;return(null===(e=a.texts)||void 0===e?void 0:e[t])||""},h=t=>a.plugins_states[t]||l,w=t=>a.texts.plugins_states[h(t)],k=()=>a.kubio_pro_active;var v=i(50),y=i(1),_=i(33);const O=t=>new Promise(((e,i)=>{const o=t instanceof window.FormData?t:new window.FormData;o.append("nonce",g()),Object(n.each)(t,((t,e)=>o.append(e,t))),v.ajax({method:"POST",url:Object(_.addQueryArgs)(a.ajax_url,{nonce:g(),action:o.get("action")}),data:o,contentType:!1,processData:!1}).done((t=>{if(!1===t.success){var n,a;const e=(null==t||null===(n=t.data)||void 0===n?void 0:n.error_message)||(null==t||null===(a=t.data)||void 0===a?void 0:a.error);i(e)}else e(t)})).fail((t=>{i(`${t.status} ( ${t.statusText} ) : ${t.responseText}`)}))})),j=async t=>await O({action:"kubio-demo-site-activate-plugin",slug:t}),x=async t=>{const e=h(t);try{switch(e){case s:return!0;case r:await j(t);break;case l:await(async t=>await O({action:"kubio-demo-site-install-plugin",slug:t}))(t),await j(t)}}catch(t){throw t}},P=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={action:"kubio-demo-site-import-data",slug:d(),first_call:!0};try{let i={};do{if(t&&e.first_call?(Object(n.each)(e,((e,i)=>t.append(i,e))),i=await O(t)):i=await O(e),e=Object(n.omit)(e,"first_call"),i.before_import_action?(D(R.PREPARING,A.PROGRESS),e={...e,before_import_action:i.before_import_action}):(D(R.PREPARING,A.DONE),D(R.CONTENT,A.PROGRESS),e=Object(n.omit)(e,"before_import_action")),"finished"===i.status){D(R.CONTENT,A.DONE);break}}while("requires-new-ajax-call"===i.status)}catch(t){M(t)}};let E=0;const N=t=>{const e=v("#kubio-template-installing"),i=e.find("#import-button"),n=e.find("[data-available-pro-only]"),a=e.find("[data-check-pro-features]");t?(n.addClass("hidden"),a.addClass("hidden"),i.attr("data-start-import",""),i.show()):(i.removeAttr("data-start-import"),i.hide(),n.removeClass("hidden"),a.removeClass("hidden"))},S=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=v("#kubio-templates-list"),i=v("#kubio-template-installing");if(t){E=window.scrollY,e.hide(),i.css("display","flex").hide().fadeIn(100),i.find("img").attr("src",p());const t=Object(y.sprintf)(m("importing_template"),c());i.find("[data-title]").html(t);const n=u(),a=i.find("[data-plugins]"),o=i.find("[data-plugins-list]");n.length?(a.show(),o.empty(),n.forEach((t=>{const e=w(t.slug);o.append(`<li><span>${t.label}</span><span>${e}</span></li>`)}))):a.hide();const s=f(),r=k();N(!(!r&&!s))}else i.css("display","flex").hide(),v("#kubio-templates-list").show(),setTimeout((()=>window.scrollTo(0,E)),5)},T=async()=>{v(".kubio-admin-page-header-start-editing").addClass("hidden");const t=v("#kubio-template-installing"),e=t.find("[data-info]"),i=t.find("[data-progress]"),n=t.find("[data-install-buttons]"),a=t.find("[data-install-success-buttons]"),o=v(".kubio-progress-bar");e.hide(),i.css("display","flex").show(),n.hide(),o.show();try{await(async()=>{try{D(R.PLUGINS,A.PROGRESS);const t=u();for(let e=0;e<t.length;e++){const{slug:i}=t[e];await x(i)}D(R.PLUGINS,A.DONE)}catch(t){M(t)}})(),await P()}catch(t){M()}o.hide(),a.show(),v(".kubio-admin-page-header-start-editing").removeClass("hidden")},C=()=>{v((()=>{v(document).on("click","#kubio-templates-list button[data-slug]",(function(){const t=v(this).data("slug");b(t),S()})),v(document).on("click","#kubio-template-installing button[data-cancel-import]",(function(){S(!1)})),v(document).on("click","#kubio-template-installing button[data-start-import]",T),v(document).on("submit","#kubio-import-demo-site",(async t=>{t.preventDefault(),t.stopPropagation();const e=t.target,i=new window.FormData(e);G=!0;const n=v(e).siblings(".kubio-progress-bar");n.show(),v(e).hide();try{await P(i)}catch(t){n.hide();const e=L(t);v("[data-kubio-manual-demo-site-errors]").append(`<div class="kubio-demo-site-manual-import-error">${e}</div>`)}n.hide()}))}))},R={PLUGINS:"plugins",PREPARING:"preparing",CONTENT:"content"},I={plugins:"data-installing-plugins",preparing:"data-preparing-for-import",content:"data-importing-content"},A={INACTIVE:"",PROGRESS:"progress",DONE:"active"},D=(t,e)=>{v(`[data-progress-list] [${I[t]}]`).attr("class",e)};let G=!1;const L=t=>{t=Object(n.castArray)(t);let e="";return t.forEach((t=>e+=`<p>${t}</p>`)),e},$=t=>{if(G)return;const e="[data-importing-errors]";v(e).show(),(t=Object(n.castArray)(t)).forEach((t=>v(`${e} [data-importing-errors-content]`).append(`<p>${t}</p>`)))},M=t=>{throw G||($(t),$(m("import_stopped")),G=!0),v(".kubio-progress-bar").hide(),v("[data-progress-list] li").attr("class",""),t},U=t=>{a=t,C()},F=v("#upgrade_to_pro_wrapper #kubio-page-builder-activate-license-form");let K=F;const Q=v(".notice #kubio-page-builder-activate-license-form");Q.length&&(K=Q);const q=v("#kubio-page-builder-check-license form");if(q.length&&(K=q),K.length){const t=K.find("input[type=text]"),e=K.parent(),i=e.find("#kubio-page-builder-activate-license-message"),n=e.find(".description"),a=e.find(".spinner-holder");function o(t){const e=jQuery(document.createElement("div")).append(t);return e.find("input,button,script,style").remove(),e.find("body").length?e.find("body").html():e.html()}function s(){i.hide()}function r(t){d(),i.attr("class","message error-message"),i.html(o(t)),i.show()}function l(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";K.hide(),i.hide(),n.hide(),a.show(),""!==t&&("loader"===t?(a.removeClass("ok"),a.find(".icon .loader").show()):"ok"===t&&a.addClass("ok")),""!==e&&a.find(".message").text(e)}function d(){K.show(),i.show(),n.show(),a.hide()}t.on("keyup change",s),K.on("submit",(function(e){e.preventDefault(),e.stopPropagation();const i=t.val();i?(s(),l("loader",Object(y.__)("Loading…","kubio")),K.addClass("disabled"),wp.ajax.send("kubiowp-page-builder-activate",{data:{key:i}}).done((function(t){F.length?(l("loader",Object(y.__)("Installing Kubio PRO…","kubio")),wp.ajax.post("kubiowp-page-builder-maybe-install-pro").done((function(){l("ok",Object(y.__)("Kubio PRO sucessfully installed","kubio"))})).fail((function(t){t.message?r(t.message):r(Object(y.__)("There was an error installing the Kubio PRO plugin","kubio"))}))):l("ok",t||Object(y.__)("Activated successfully","kubio"))})).fail((function(t){d(),K.removeClass("disabled"),r(t.responseJSON.data)}))):r(Object(y.__)("License key is empty","kubio"))})),q.length&&window.wp&&window.wp.ajax&&wp.ajax.send("kubiowp-page-builder-check-license").fail((function(t){K.closest(".notice").removeClass("hidden"),r(o(t.responseJSON.data))}))}const J=v("#adminmenu .toplevel_page_kubio");if(J.length){const t=window.location.search,e=new URLSearchParams(t);if("kubio-get-started"===e.get("page")){const t=e.get("tab");null!==t&&(J.find("li.current").removeClass("current"),J.find("a[href*='tab="+t+"']").length?J.find("a[href*='tab="+t+"']").closest("li").addClass("current"):J.find("li.wp-first-item").next().addClass("current"))}J.find("a[href*='tab=pro-upgrade']").length&&J.find("a[href*='tab=pro-upgrade']").closest("li").addClass("li-pro-upgrade")}setTimeout((()=>{v(".kubio-admin-page-page-section").eq(0).append(v(".kubio-admin-row.get-started-imported"))}),100)}});
